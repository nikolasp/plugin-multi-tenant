import { withTenantAccess } from "./withTenantAccess";
const collectionAccessKeys = [
    'create',
    'read',
    'update',
    'delete',
    'readVersions',
    'unlock'
];
/**
 * Adds tenant access constraint to collection
 * - constrains access a users assigned tenants
 */ export const addCollectionAccess = ({ collection, fieldName, userHasAccessToAllTenants })=>{
    if (!collection?.access) {
        collection.access = {};
    }
    collectionAccessKeys.reduce((acc, key)=>{
        if (!collection.access) {
            return acc;
        }
        collection.access[key] = withTenantAccess({
            accessFunction: collection.access?.[key],
            fieldName,
            userHasAccessToAllTenants
        });
        return acc;
    }, {});
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsaXRpZXMvYWRkQ29sbGVjdGlvbkFjY2Vzcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEFjY2VzcywgQ29sbGVjdGlvbkNvbmZpZyB9IGZyb20gJ3BheWxvYWQnXG5cbmltcG9ydCB0eXBlIHsgTXVsdGlUZW5hbnRQbHVnaW5Db25maWcgfSBmcm9tICcuLi90eXBlcydcblxuaW1wb3J0IHsgd2l0aFRlbmFudEFjY2VzcyB9IGZyb20gJy4vd2l0aFRlbmFudEFjY2VzcydcblxudHlwZSBBbGxBY2Nlc3NLZXlzPFQgZXh0ZW5kcyByZWFkb25seSBzdHJpbmdbXT4gPSBUW251bWJlcl0gZXh0ZW5kcyBrZXlvZiBPbWl0PFxuICBSZXF1aXJlZDxDb2xsZWN0aW9uQ29uZmlnPlsnYWNjZXNzJ10sXG4gICdhZG1pbidcbj5cbiAgPyBrZXlvZiBPbWl0PFJlcXVpcmVkPENvbGxlY3Rpb25Db25maWc+WydhY2Nlc3MnXSwgJ2FkbWluJz4gZXh0ZW5kcyBUW251bWJlcl1cbiAgICA/IFRcbiAgICA6IG5ldmVyXG4gIDogbmV2ZXJcblxuY29uc3QgY29sbGVjdGlvbkFjY2Vzc0tleXM6IEFsbEFjY2Vzc0tleXM8XG4gIFsnY3JlYXRlJywgJ3JlYWQnLCAndXBkYXRlJywgJ2RlbGV0ZScsICdyZWFkVmVyc2lvbnMnLCAndW5sb2NrJ11cbj4gPSBbJ2NyZWF0ZScsICdyZWFkJywgJ3VwZGF0ZScsICdkZWxldGUnLCAncmVhZFZlcnNpb25zJywgJ3VubG9jayddIGFzIGNvbnN0XG5cbnR5cGUgQXJnczxDb25maWdUeXBlPiA9IHtcbiAgY29sbGVjdGlvbjogQ29sbGVjdGlvbkNvbmZpZ1xuICBmaWVsZE5hbWU6IHN0cmluZ1xuICB1c2VySGFzQWNjZXNzVG9BbGxUZW5hbnRzOiBSZXF1aXJlZDxcbiAgICBNdWx0aVRlbmFudFBsdWdpbkNvbmZpZzxDb25maWdUeXBlPlxuICA+Wyd1c2VySGFzQWNjZXNzVG9BbGxUZW5hbnRzJ11cbn1cblxuLyoqXG4gKiBBZGRzIHRlbmFudCBhY2Nlc3MgY29uc3RyYWludCB0byBjb2xsZWN0aW9uXG4gKiAtIGNvbnN0cmFpbnMgYWNjZXNzIGEgdXNlcnMgYXNzaWduZWQgdGVuYW50c1xuICovXG5leHBvcnQgY29uc3QgYWRkQ29sbGVjdGlvbkFjY2VzcyA9IDxDb25maWdUeXBlPih7XG4gIGNvbGxlY3Rpb24sXG4gIGZpZWxkTmFtZSxcbiAgdXNlckhhc0FjY2Vzc1RvQWxsVGVuYW50cyxcbn06IEFyZ3M8Q29uZmlnVHlwZT4pOiB2b2lkID0+IHtcbiAgaWYgKCFjb2xsZWN0aW9uPy5hY2Nlc3MpIHtcbiAgICBjb2xsZWN0aW9uLmFjY2VzcyA9IHt9XG4gIH1cbiAgY29sbGVjdGlvbkFjY2Vzc0tleXMucmVkdWNlPHtcbiAgICBba2V5IGluICh0eXBlb2YgY29sbGVjdGlvbkFjY2Vzc0tleXMpW251bWJlcl1dPzogQWNjZXNzXG4gIH0+KChhY2MsIGtleSkgPT4ge1xuICAgIGlmICghY29sbGVjdGlvbi5hY2Nlc3MpIHtcbiAgICAgIHJldHVybiBhY2NcbiAgICB9XG4gICAgY29sbGVjdGlvbi5hY2Nlc3Nba2V5XSA9IHdpdGhUZW5hbnRBY2Nlc3M8Q29uZmlnVHlwZT4oe1xuICAgICAgYWNjZXNzRnVuY3Rpb246IGNvbGxlY3Rpb24uYWNjZXNzPy5ba2V5XSxcbiAgICAgIGZpZWxkTmFtZSxcbiAgICAgIHVzZXJIYXNBY2Nlc3NUb0FsbFRlbmFudHMsXG4gICAgfSlcblxuICAgIHJldHVybiBhY2NcbiAgfSwge30pXG59XG4iXSwibmFtZXMiOlsid2l0aFRlbmFudEFjY2VzcyIsImNvbGxlY3Rpb25BY2Nlc3NLZXlzIiwiYWRkQ29sbGVjdGlvbkFjY2VzcyIsImNvbGxlY3Rpb24iLCJmaWVsZE5hbWUiLCJ1c2VySGFzQWNjZXNzVG9BbGxUZW5hbnRzIiwiYWNjZXNzIiwicmVkdWNlIiwiYWNjIiwia2V5IiwiYWNjZXNzRnVuY3Rpb24iXSwibWFwcGluZ3MiOiJBQUlBLFNBQVNBLGdCQUFnQixRQUFRLHFCQUFvQjtBQVdyRCxNQUFNQyx1QkFFRjtJQUFDO0lBQVU7SUFBUTtJQUFVO0lBQVU7SUFBZ0I7Q0FBUztBQVVwRTs7O0NBR0MsR0FDRCxPQUFPLE1BQU1DLHNCQUFzQixDQUFhLEVBQzlDQyxVQUFVLEVBQ1ZDLFNBQVMsRUFDVEMseUJBQXlCLEVBQ1I7SUFDakIsSUFBSSxDQUFDRixZQUFZRyxRQUFRO1FBQ3ZCSCxXQUFXRyxNQUFNLEdBQUcsQ0FBQztJQUN2QjtJQUNBTCxxQkFBcUJNLE1BQU0sQ0FFeEIsQ0FBQ0MsS0FBS0M7UUFDUCxJQUFJLENBQUNOLFdBQVdHLE1BQU0sRUFBRTtZQUN0QixPQUFPRTtRQUNUO1FBQ0FMLFdBQVdHLE1BQU0sQ0FBQ0csSUFBSSxHQUFHVCxpQkFBNkI7WUFDcERVLGdCQUFnQlAsV0FBV0csTUFBTSxFQUFFLENBQUNHLElBQUk7WUFDeENMO1lBQ0FDO1FBQ0Y7UUFFQSxPQUFPRztJQUNULEdBQUcsQ0FBQztBQUNOLEVBQUMifQ==