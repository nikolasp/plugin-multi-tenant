import { withTenantAccess } from "./withTenantAccess";
const collectionAccessKeys = [
    'create',
    'read',
    'update',
    'delete',
    'readVersions',
    'unlock'
];
/**
 * Adds tenant access constraint to collection
 * - constrains access a users assigned tenants
 */ export const addCollectionAccess = ({ collection, fieldName, userHasAccessToAllTenants })=>{
    collectionAccessKeys.forEach((key)=>{
        if (!collection.access) {
            collection.access = {};
        }
        collection.access[key] = withTenantAccess({
            accessFunction: collection.access?.[key],
            fieldName: key === 'readVersions' ? `version.${fieldName}` : fieldName,
            userHasAccessToAllTenants
        });
    });
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsaXRpZXMvYWRkQ29sbGVjdGlvbkFjY2Vzcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IENvbGxlY3Rpb25Db25maWcgfSBmcm9tICdwYXlsb2FkJ1xuXG5pbXBvcnQgdHlwZSB7IE11bHRpVGVuYW50UGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vdHlwZXMnXG5cbmltcG9ydCB7IHdpdGhUZW5hbnRBY2Nlc3MgfSBmcm9tICcuL3dpdGhUZW5hbnRBY2Nlc3MnXG5cbnR5cGUgQWxsQWNjZXNzS2V5czxUIGV4dGVuZHMgcmVhZG9ubHkgc3RyaW5nW10+ID0gVFtudW1iZXJdIGV4dGVuZHMga2V5b2YgT21pdDxcbiAgUmVxdWlyZWQ8Q29sbGVjdGlvbkNvbmZpZz5bJ2FjY2VzcyddLFxuICAnYWRtaW4nXG4+XG4gID8ga2V5b2YgT21pdDxSZXF1aXJlZDxDb2xsZWN0aW9uQ29uZmlnPlsnYWNjZXNzJ10sICdhZG1pbic+IGV4dGVuZHMgVFtudW1iZXJdXG4gICAgPyBUXG4gICAgOiBuZXZlclxuICA6IG5ldmVyXG5cbmNvbnN0IGNvbGxlY3Rpb25BY2Nlc3NLZXlzOiBBbGxBY2Nlc3NLZXlzPFxuICBbJ2NyZWF0ZScsICdyZWFkJywgJ3VwZGF0ZScsICdkZWxldGUnLCAncmVhZFZlcnNpb25zJywgJ3VubG9jayddXG4+ID0gWydjcmVhdGUnLCAncmVhZCcsICd1cGRhdGUnLCAnZGVsZXRlJywgJ3JlYWRWZXJzaW9ucycsICd1bmxvY2snXSBhcyBjb25zdFxuXG50eXBlIEFyZ3M8Q29uZmlnVHlwZT4gPSB7XG4gIGNvbGxlY3Rpb246IENvbGxlY3Rpb25Db25maWdcbiAgZmllbGROYW1lOiBzdHJpbmdcbiAgdXNlckhhc0FjY2Vzc1RvQWxsVGVuYW50czogUmVxdWlyZWQ8XG4gICAgTXVsdGlUZW5hbnRQbHVnaW5Db25maWc8Q29uZmlnVHlwZT5cbiAgPlsndXNlckhhc0FjY2Vzc1RvQWxsVGVuYW50cyddXG59XG5cbi8qKlxuICogQWRkcyB0ZW5hbnQgYWNjZXNzIGNvbnN0cmFpbnQgdG8gY29sbGVjdGlvblxuICogLSBjb25zdHJhaW5zIGFjY2VzcyBhIHVzZXJzIGFzc2lnbmVkIHRlbmFudHNcbiAqL1xuZXhwb3J0IGNvbnN0IGFkZENvbGxlY3Rpb25BY2Nlc3MgPSA8Q29uZmlnVHlwZT4oe1xuICBjb2xsZWN0aW9uLFxuICBmaWVsZE5hbWUsXG4gIHVzZXJIYXNBY2Nlc3NUb0FsbFRlbmFudHMsXG59OiBBcmdzPENvbmZpZ1R5cGU+KTogdm9pZCA9PiB7XG4gIGNvbGxlY3Rpb25BY2Nlc3NLZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgIGlmICghY29sbGVjdGlvbi5hY2Nlc3MpIHtcbiAgICAgIGNvbGxlY3Rpb24uYWNjZXNzID0ge31cbiAgICB9XG4gICAgY29sbGVjdGlvbi5hY2Nlc3Nba2V5XSA9IHdpdGhUZW5hbnRBY2Nlc3M8Q29uZmlnVHlwZT4oe1xuICAgICAgYWNjZXNzRnVuY3Rpb246IGNvbGxlY3Rpb24uYWNjZXNzPy5ba2V5XSxcbiAgICAgIGZpZWxkTmFtZToga2V5ID09PSAncmVhZFZlcnNpb25zJyA/IGB2ZXJzaW9uLiR7ZmllbGROYW1lfWAgOiBmaWVsZE5hbWUsXG4gICAgICB1c2VySGFzQWNjZXNzVG9BbGxUZW5hbnRzLFxuICAgIH0pXG4gIH0pXG59XG4iXSwibmFtZXMiOlsid2l0aFRlbmFudEFjY2VzcyIsImNvbGxlY3Rpb25BY2Nlc3NLZXlzIiwiYWRkQ29sbGVjdGlvbkFjY2VzcyIsImNvbGxlY3Rpb24iLCJmaWVsZE5hbWUiLCJ1c2VySGFzQWNjZXNzVG9BbGxUZW5hbnRzIiwiZm9yRWFjaCIsImtleSIsImFjY2VzcyIsImFjY2Vzc0Z1bmN0aW9uIl0sIm1hcHBpbmdzIjoiQUFJQSxTQUFTQSxnQkFBZ0IsUUFBUSxxQkFBb0I7QUFXckQsTUFBTUMsdUJBRUY7SUFBQztJQUFVO0lBQVE7SUFBVTtJQUFVO0lBQWdCO0NBQVM7QUFVcEU7OztDQUdDLEdBQ0QsT0FBTyxNQUFNQyxzQkFBc0IsQ0FBYSxFQUM5Q0MsVUFBVSxFQUNWQyxTQUFTLEVBQ1RDLHlCQUF5QixFQUNSO0lBQ2pCSixxQkFBcUJLLE9BQU8sQ0FBQyxDQUFDQztRQUM1QixJQUFJLENBQUNKLFdBQVdLLE1BQU0sRUFBRTtZQUN0QkwsV0FBV0ssTUFBTSxHQUFHLENBQUM7UUFDdkI7UUFDQUwsV0FBV0ssTUFBTSxDQUFDRCxJQUFJLEdBQUdQLGlCQUE2QjtZQUNwRFMsZ0JBQWdCTixXQUFXSyxNQUFNLEVBQUUsQ0FBQ0QsSUFBSTtZQUN4Q0gsV0FBV0csUUFBUSxpQkFBaUIsQ0FBQyxRQUFRLEVBQUVILFdBQVcsR0FBR0E7WUFDN0RDO1FBQ0Y7SUFDRjtBQUNGLEVBQUMifQ==